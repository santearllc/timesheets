<div class="close_menu_btn_par" [class.hideAddRemove]="!entry_vars.edit_line_items" [class.showAddRemove]="entry_vars.edit_line_items">


	<div class="close_btn" style="" (click)="showEditLineItems([entry_vars])">
		click when done editing line items
	</div>

</div>

<!-- Popup used to inform user of important actions (typically includes a confirm or cancel button) -->
<div *ngIf="entry_vars.showPopup" class="popup">
	<div>
		<div class="popup_title" [innerHTML]="popup.title | safeHtml: 'html'"></div>
		<div class="popup_text" [innerHTML]="popup.text | safeHtml: 'html'"></div>
		<div class="popup_buttons">
			<button *ngFor="let button of popup.buttons" (click)="popupFunction(button.action)">{{ button.label }}</button>
		</div>
	</div>
</div>

<!-- Menu is used during testing -->
<div class="debug_settings" *ngIf="true">
	<div onClick="$(this).next().toggle()" style="cursor:pointer;">Testing Menu</div>
	<div class="debug_items" style="">
		<div class="alt_btn" (click)="(current_office==1) ? current_office=0 : current_office=1;updateTimesheetTotals();">Toggle Location: {{ (current_office == 1) ? 'CAN' : 'US'}}</div>
		<div class="alt_btn" (click)="loadInitTimeheet()">Clear Timesheet (reset)</div>
		<div class="alt_btn" (click)="loadSampleTimesheet()">Load Sample Time Sheet</div>
	</div>
</div>

<!-- Main section of component -->

<div style="margin-bottom: 10px;">
	<div>
		<h1>{{username}}</h1>
	</div>
	<div class="alt_btn" style="display:inline-block;" (click)="(entry_vars.showCal) ? entry_vars.showCal = false : entry_vars.showCal = true;">{{timesheet_date}}</div>

	<!-- Texual and graphical indicator for save state; defaults to hidden until an action is made -->
	<div *ngIf="save_status" style="float:right;color:#555;" (click)="saveTimesheet()">
		{{ save_status }}
		<svg height="10" width="10">
			<circle cx="5" cy="5" r="5" stroke="black" stroke-width="3" [attr.fill]="save_status_color" />
		</svg>
	</div>

	<!-- This static calendar will be replaced with a script generated one  <app-calendar></app-calendar> -->
	<div *ngIf="entry_vars.showCal" id="cal">
		<div style="padding-bottom:5px;margin-bottom:10px;border-bottom:1px #DDD solid;">
			<table width="100%;">
				<tr>
					<td>&larr;</td>
					<td style="text-align:center;">December 2017</td>
					<td>&rarr;</td>
				</tr>
			</table>
		</div>
		<table class="cal_weeks" width="100%;">
			<tr class="disable-clicks">
				<td *ngFor="let day_i of days_label" style="font-weight:700;">{{ day_i }}</td>
			</tr>
			<tr (click)="weekSelected(0)">
				<td class="cal_dif_mo">27</td>
				<td class="cal_dif_mo">28</td>
				<td class="cal_dif_mo">29</td>
				<td class="cal_dif_mo">30</td>
				<td>1</td>
				<td>2</td>
				<td>3</td>
			</tr>
			<tr class="cal_days" (click)="weekSelected(1)">
				<td>4</td>
				<td>5</td>
				<td>6</td>
				<td>7</td>
				<td>8</td>
				<td>9</td>
				<td>10</td>
			</tr>
			<tr (click)="weekSelected(2)">
				<td>11</td>
				<td>12</td>
				<td>13</td>
				<td>14</td>
				<td>15</td>
				<td>16</td>
				<td>17</td>
			</tr>
			<tr (click)="weekSelected(3)">
				<td>18</td>
				<td>19</td>
				<td>20</td>
				<td>21</td>
				<td>22</td>
				<td>23</td>
				<td>24</td>
			</tr>
			<tr (click)="weekSelected(4)">
				<td>25</td>
				<td>26</td>
				<td>27</td>
				<td>28</td>
				<td>29</td>
				<td>30</td>
				<td>31</td>
			</tr>
		</table>
	</div>
</div>

<!-- Timesheet Generation -->
<div class="cat_1 projects" *ngFor="let x_1 of timesheet; let i_0 = 'index'" style="margin-bottom: 10px;">
	<div class="cat_1_title">
		<table style="width:100%;">
			<tr>
				<td style="width: 200px;font-size:1.5em;font-weight: 700;">
					<div>{{ titles[x_1.cat_key]['Title'] }}</div>
				</td>
				<td>
					<table style="width: 100%;">
						<tr>
							<td class="blank">&nbsp;</td>
							<td *ngFor="let day_i of days_label" class="day">{{ day_i }}</td>
							<td class="blank">&nbsp;</td>
							<td class="sum">&nbsp;</td>
							<td style="width:1%;">
								<div class="empty">&nbsp;</div>
							</td>
						</tr>
					</table>
				</td>
			</tr>
		</table>
		<!-- Add new row options -->
		<div class="addRowOption" style="margin-top:10px;">

			<!-- This div is for project searching -->
			<div *ngIf="x_1.cat_key == 0">				
				<div class="dd_div">
					<div class="dd_search">
						<div style="width:90%;display:inline-block;">
							<input placeholder="Search for Show (name or code)" [(ngModel)]="x_1.searchDD" type="text" (keyup)="x_1.dd_results = searchDropDown(x_1.searchDD, projects,[x_1]);dropDownKey($event, x_1, x_1.dd_results,[x_1], 'project');" (click)="x_1.searchDD='';x_1.dd_results = searchDropDown(x_1.searchDD, projects)"/>
						</div><!--
						--><div style="width:10%;display:inline-block;text-align:right;visibility:hidden;">
							<div class="dd_reveal" (click)="x_1.dd_results = dropDownReset($event, projects)">&#9660;</div>
						</div>
					</div>
					<div *ngIf="x_1.dd_results">
						<div *ngIf="x_1.dd_results.length > 0" (mouseover)="x_1.dd_results = dropDownReset(false, x_1.dd_results);" class="dd_results" style="width:770px;">
							<div *ngFor="let result of x_1.dd_results" [class.dd_result_sel]="result.selected" [attr.data-cats]="[x_1]" (click)="x_1.department=x_1.cat_key;selectProject(result, x_1)">{{ result.Cat_Title }}</div>
						</div>
					</div>					
				</div>


				<div style="z-index:1000;" class="addRowOption_ProjectList">
					<div *ngFor="let el of x_1.results" (click)="selectProject(el, x_1)" style="">{{ el.Cat_Title }}</div>
				</div>
			</div>
		</div>
	</div>

	<div class="cat_1_content" *ngIf="x_1.children.length > 0">
		<div *ngFor="let x_2 of x_1.children; let last = last;let first = first; let i_2 = 'index'" [class]="(!x_2.indicateRemoval) ? '' : 'indicateRemoval'">
			<div *ngIf="!first">&nbsp;</div>
			<div style="border-bottom:1px #BBB solid;padding-bottom:0px;margin-bottom: 5px;">
				<table style="width:100%;">
					<tr>
						<td style="width: 200px;" class="cat_0_title">
							<div>{{ titles[x_1.cat_key][x_2.cat_key]['Title'] }}</div>
						</td>
						<td>
							<table style="width: 100%;" [class]="(entry_vars.timesheet_submitted) ? 'disable-clicks' : ''">
								<tr>
									<td class="blank">&nbsp;</td>
									<td *ngFor="let day_i of days;" [class]="x_2.ot[day_i] && x_2.ot_req[day_i] && entry_vars.ot_req[day_i] > 1 ? 'ot_selected day' : 'ot day'">
										<div (click)="setOvertimeChoice(x_1.cat_key, x_2.cat_key, day_i)" *ngIf="x_2.ot_req[day_i] && x_2.sum_hours[day_i] > 0.0 && entry_vars.ot_req[day_i] > 1">OT</div>
									</td>
									<td class="blank">&nbsp;</td>
									<td class="sum" style="text-align:right;">

									</td>
									<td style="width:1%;">
										<div>
											<div class="menu" (click)="(x_2.show_menu) ? x_2.show_menu = false : x_2.show_menu = true"></div>
											<div *ngIf="x_2.show_menu" class="menu_div">
												<div *ngIf="x_1.cat_key == 0">
													<div (click)="removeLineItem(x_2.children, i_2,[x_1.cat_key,x_2.cat_key])">Remove Project</div>
												</div>

												<div (click)="showEditLineItems([x_1, x_2])">Edit Line Items</div>
											</div>
										</div>

									</td>
								</tr>
							</table>
						</td>
					</tr>
				</table>
			</div>
			<!-- Add new row options -->
			<div *ngIf="!entry_vars.timesheet_submitted" class="addRowOption" style="margin-bottom:15px;">

				<div *ngIf="x_1.cat_key == 0">
					<table width="100%">
						<tr>
							<td width="33%">
								<div class="dd_div">
									<div class="dd_search">
										<div style="width:90%;display:inline-block;">
											<input placeholder="Select Category" [(ngModel)]="x_2.searchDD_projectTask" type="text" (keyup)="x_2.dd_results_projectTask = searchDropDown(x_2.searchDD_projectTask, project_tasks,[x_1,x_2]);dropDownKey($event, x_2, x_2.dd_results_projectTask,[x_1,x_2],'projectTask');" (click)="resetNewLine($event,x_2);x_2.projectTask=-1;x_2.searchDD_projectTask='';x_2.dd_results = searchDropDown(x_2.searchDD_projectTask, project_tasks)"/>
										</div><!--
										--><div style="width:10%;display:inline-block;text-align:right;">
											<div class="dd_reveal" (click)="resetNewLine($event, x_2); x_2.dd_results_projectTask = dropDownReset($event, project_tasks)">&#9660;</div>
										</div>
									</div>
									<div *ngIf="x_2.dd_results_projectTask">
										<div *ngIf="x_2.dd_results_projectTask.length > 0" (mouseover)="x_2.dd_results = dropDownReset(false, x_2.dd_results_projectTask);" class="dd_results" style="width:255px;">
											<div *ngFor="let result of x_2.dd_results_projectTask" [class.dd_result_sel]="result.selected" (click)="x_2.projectTask=result.Cat_key;x_2.searchDD_projectTask=result.Cat_Title;x_2.dd_results_projectTask=false;addRowOptionChange([x_1,x_2],result)">{{ result.Cat_Title }}</div>
											
										</div>
									</div>						
								</div>

							</td>
							<td width="34%">
								<div *ngIf="x_2.projectTask != 4 && x_2.projectTask != 5 && x_2.projectTask != 6">   <!--  Nothing Selected  -->
									<div class="dd_div" style="opacity:0.25;">
										<div class="dd_search">
											<div style="width:90%;display:inline-block;">
												<input placeholder="Select Step" type="text" disabled/>
											</div><!--
											--><div style="width:10%;display:inline-block;text-align:right;">
												<div class="dd_reveal" (click)="x_2.dd_results_shotTask = dropDownReset($event, asset_tasks)">&#9660;</div>
											</div>
										</div>										
									</div>
								</div>
								<div *ngIf="x_2.projectTask == 6"> <!--  Produciton Task  -->
									<div class="dd_div">
										<div class="dd_search">
											<div style="width:90%;display:inline-block;">
												<input placeholder="Select Step" [(ngModel)]="x_2.searchDD_productionTask" type="text" (keyup)="x_2.dd_results_productionTask = searchDropDown(x_2.searchDD_productionTask, production_tasks,[x_1,x_2]);dropDownKey($event, x_2, x_2.dd_results_productionTask,[x_1,x_2], 'productionTask');" (click)="x_2.searchDD_productionTask='';x_2.dd_results_productionTask = searchDropDown(x_2.searchDD_productionTask, production_tasks)"/>
											</div><!--
											--><div style="width:10%;display:inline-block;text-align:right;">
												<div class="dd_reveal" (click)="x_2.dd_results_productionTask = dropDownReset($event, production_tasks)">&#9660;</div>
											</div>
										</div>
										<div *ngIf="x_2.dd_results_productionTask">
											<div *ngIf="x_2.dd_results_productionTask.length > 0" (mouseover)="x_2.dd_results_productionTask = dropDownReset(false, x_2.dd_results_productionTask);" class="dd_results" style="width:255px;">
												<div *ngFor="let result of x_2.dd_results_productionTask" [class.dd_result_sel]="result.selected" (click)="x_2.productionTask=result.Cat_key;x_2.searchDD_productionTask=result.Cat_Title;x_2.dd_results_productionTask=false;addRowOptionChange([x_1,x_2],result)">{{ result.Cat_Title }}</div>
											</div>
										</div>						
									</div>
								</div>
								<div *ngIf="x_2.projectTask == 4"> <!--  Asset Task  -->
									<div class="dd_div">
										<div class="dd_search">
											<div style="width:90%;display:inline-block;">
												<input placeholder="Select Step" [(ngModel)]="x_2.searchDD_assetTask" type="text" (keyup)="x_2.dd_results_assetTask = searchDropDown(x_2.searchDD_assetTask, asset_tasks,[x_1,x_2]);dropDownKey($event, x_2, x_2.dd_results_assetTask,[x_1,x_2], 'assetTask');" (click)="x_2.searchDD_assetTask='';x_2.dd_results_assetTask = searchDropDown(x_2.searchDD_assetTask, asset_tasks)"/>
											</div><!--
											--><div style="width:10%;display:inline-block;text-align:right;">
												<div class="dd_reveal" (click)="x_2.dd_results_assetTask = dropDownReset($event, asset_tasks)">&#9660;</div>
											</div>
										</div>
										<div *ngIf="x_2.dd_results_assetTask">
											<div *ngIf="x_2.dd_results_assetTask.length > 0" (mouseover)="x_2.dd_results_assetTask = dropDownReset(false, x_2.dd_results_assetTask);" class="dd_results" style="width:255px;">
												<div *ngFor="let result of x_2.dd_results_assetTask" [class.dd_result_sel]="result.selected" (click)="x_2.assetTask=result.Cat_key;x_2.searchDD_assetTask=result.Cat_Title;x_2.dd_results_assetTask=false;addRowOptionChange([x_1,x_2],result)">{{ result.Cat_Title }}</div>
											</div>
										</div>						
									</div>
								</div>
								<div *ngIf="x_2.projectTask == 5"> <!--  Shot Task  -->
									<div class="dd_div">
										<div class="dd_search">
											<div style="width:90%;display:inline-block;">
												<input placeholder="Select Step" [(ngModel)]="x_2.searchDD_shotTask" type="text" (keyup)="x_2.dd_results_shotTask = searchDropDown(x_2.searchDD_shotTask, shot_tasks,[x_1,x_2]);dropDownKey($event, x_2, x_2.dd_results_shotTask,[x_1,x_2], 'shotTask');" (click)="x_2.searchDD_shotTask='';x_2.dd_results_shotTask = searchDropDown(x_2.searchDD_shotTask, shot_tasks)"/>
											</div><!--
											--><div style="width:10%;display:inline-block;text-align:right;">
												<div class="dd_reveal" (click)="x_2.dd_results_shotTask = dropDownReset($event, shot_tasks)">&#9660;</div>
											</div>
										</div>
										<div *ngIf="x_2.dd_results_shotTask">
											<div *ngIf="x_2.dd_results_shotTask.length > 0" (mouseover)="x_2.dd_results_shotTask = dropDownReset(false, x_2.dd_results_shotTask);" class="dd_results" style="width:255px;">
												<div *ngFor="let result of x_2.dd_results_shotTask" [class.dd_result_sel]="result.selected" (click)="x_2.shotTask=result.Cat_key;x_2.searchDD_shotTask=result.Cat_Title;x_2.dd_results_shotTask=false;addRowOptionChange([x_1,x_2],result)">{{ result.Cat_Title }}</div>
											</div>
										</div>						
									</div>
								</div>
							</td>
							<td width="33%">

								<div *ngIf="x_2.projectTask != 4 && x_2.projectTask != 5">   <!--  Nothing Selected  -->
									<div class="dd_div" style="opacity:0.25;">
										<div class="dd_search">
											<div style="width:100%;display:inline-block;">
												<input placeholder="Search for Shot/Asset" type="text" disabled/>
											</div>
										</div>										
									</div>
								</div>
								<div *ngIf="x_2.projectTask == 4 || x_2.projectTask == 5" class="dd_div">
									<div class="dd_search">
										<div style="width:90%;display:inline-block;">
											<input placeholder="Search for Shot/Asset" [(ngModel)]="x_2.searchDD_shot" type="text" (keyup)="x_2.dd_results_shot = searchDropDown(x_2.searchDD_shot, (x_2.projectTask == 4) ? assets : shots,[x_1,x_2]);dropDownKey($event, x_2, x_2.dd_results_shot,[x_1,x_2], 'shot');" (click)="x_2.searchDD_shot='';x_2.dd_results_shot = searchDropDown(x_2.searchDD_shot, (x_2.projectTask == 4) ? assets : shots)"/>
										</div><!--
										--><div style="width:10%;display:inline-block;text-align:right;visibility:hidden;">
											<div class="dd_reveal" (click)="x_2.dd_results_shot = dropDownReset($event, (x_2.projectTask == 4) ? assets : shots)">&#9660;</div>
										</div>
									</div>
									<div *ngIf="x_2.dd_results_shot">
										<div *ngIf="x_2.dd_results_shot.length > 0" (mouseover)="x_2.dd_results_shot = dropDownReset(false, x_2.dd_results_shot);" class="dd_results" style="width:255px;">
											<div *ngFor="let result of x_2.dd_results_shot" [class.dd_result_sel]="result.selected" (click)="x_2.shot_selected=result;x_2.searchDD_shot=result.Cat_Title;x_2.dd_results_shot=false;addRowOptionChange([x_1,x_2],result)">{{ result.Cat_Title }}</div>
										</div>
									</div>						
								</div>
								<!-- </div>-->
							</td>
						</tr>
					</table>

				</div>

				<div *ngIf="x_1.cat_key == 1">
					<div class="dd_div">
						<div class="dd_search">
							<div style="width:90%;display:inline-block;">
								<input placeholder="Select Task" [(ngModel)]="x_2.searchDD_departmentTask" type="text" (keyup)="x_2.dd_results_departmentTask = searchDropDown(x_2.searchDD_departmentTask, department_tasks,[x_1,x_2]);dropDownKey($event, x_2, x_2.dd_results_departmentTask,[x_1,x_2], 'shotTask');" (click)="x_2.searchDD_departmentTask='';x_2.dd_results_departmentTask = searchDropDown(x_2.searchDD_departmentTask, department_tasks)"/>
							</div><!--
							--><div style="width:10%;display:inline-block;text-align:right;">
								<div class="dd_reveal" (click)="x_2.dd_results_departmentTask = dropDownReset($event, department_tasks)">&#9660;</div>
							</div>
						</div>
						<div *ngIf="x_2.dd_results_departmentTask">
							<div *ngIf="x_2.dd_results_departmentTask.length > 0" (mouseover)="x_2.dd_results_departmentTask = dropDownReset(false, x_2.dd_results_departmentTask);" class="dd_results" style="width:770px;">
								<div *ngFor="let result of x_2.dd_results_departmentTask" [class.dd_result_sel]="result.selected" (click)="x_2.shotTask=result.Cat_key;x_2.searchDD_departmentTask=result.Cat_Title;x_2.dd_results_departmentTask=false;addRowOptionChange([x_1,x_2],result)">{{ result.Cat_Title }}</div>
							</div>
						</div>						
					</div>
				</div>
			</div>
			<div *ngFor="let x_3 of x_2.children; let i_2 = 'index' " [class]="(!x_3.indicateRemoval) ? '' : 'indicateRemoval'">
				<div *ngIf="x_3.hours">
					<table style="width:100%;" [class.addedLine]="(x_1.cat_key + '_' + x_2.cat_key + '_' + x_3.cat_key) == entry_vars.cur_sel">
						<tr>
							<td class="title">
								<div style="width: 200px;">
									<div>{{ titles[x_1.cat_key][x_2.cat_key][x_3.cat_key]['Title'] }}</div>
								</div>
							</td>
							<td>
								<table style="width: 100%;">
									<tr>
										<td class="blank">&nbsp;</td>
										<td *ngFor="let day_i of days;" [class.day]="(x_3.hours[day_i] > 0 || x_3.focus[day_i])" [class.day_zero]="x_3.hours[day_i] <= 0 && !x_3.focus[day_i]">
											<input type="text" value="{{ x_3.hours[day_i] > 0 ? x_3.hours[day_i] : '' }}" (focus)="x_3.focus[day_i] = true;" (keyup)="updateHours($event,x_3.hours, day_i)"
											 (keypress)="isNumberKey($event)" (blur)="updateHours($event,x_3.hours, day_i);x_3.focus[day_i] = false;" [class]="x_2.ot[day_i] && x_2.ot_req[day_i] && entry_vars.ot_req[day_i] > 1 ? 'ot_cell' : ''"
											 [disabled]="entry_vars.timesheet_submitted" [style.border]="(entry_vars.timesheet_submitted) ? 'none' : ''" />
										</td>
										<td class="blank">&nbsp;</td>
										<td class="sum hour_sum">
											<div>{{ (x_3.hours[1] + x_3.hours[2] + x_3.hours[3] + x_3.hours[4] + x_3.hours[5] + x_3.hours[6] + x_3.hours[0]) |
												number : '1.2-2'}}</div>
										</td>
										<td style="width:1%;">
											<div *ngIf="!entry_vars.show_edit_line_items" [style.opacity]="(entry_vars.timesheet_submitted && x_3.note.length <= 0) ? 0.0 : default"
											 title="Note" (click)="(entry_vars.timesheet_submitted) ? '' : notesToggle(x_3)" (mouseover)="x_3.show_note=true"
											 (mouseout)="x_3.show_note=false" [class]="(x_3.note.length > 0) ? 'note_sel' : 'note'">&nbsp;</div>

											<div *ngIf="entry_vars.show_edit_line_items && !(x_1.cat_key == 1 && x_3.cat_key == 11)" [style.opacity]="(entry_vars.timesheet_submitted) ? 0.0 : default"
											 title="Remove" class="minus" (click)="removeLineItem(x_2.children, i_2,[x_1.cat_key,x_2.cat_key,x_3.cat_key])">&nbsp;</div>
											<div *ngIf="entry_vars.show_edit_line_items && (x_1.cat_key == 1 && x_3.cat_key == 11)" [style.opacity]="(entry_vars.timesheet_submitted) ? 0.0 : .15"
											 title="" class="minus">&nbsp;</div>
										</td>
									</tr>
								</table>
							</td>
						</tr>
					</table>
					<div *ngIf="x_3.show_note_force">
						<div *ngIf="!submit_date">
							<textarea (keyup)="notesUpdate($event,x_3)" class="note_textarea" rows=7>{{ x_3.note }}</textarea>
						</div>
						<div class="note_text" *ngIf="x_3.show_note && submit_date && x_3.note.trim().length > 0">
							<div>{{ x_3.note }}</div>
						</div>
					</div>
					<div class="note_text" *ngIf="x_3.show_note && !x_3.show_note_force && x_3.note.trim().length > 0">
						<div>{{ x_3.note }}</div>
					</div>
				</div>
				<div *ngIf="x_3.cat_key == 6 && x_1.cat_key == 0">

					<div style="margin-top:20px;margin-bottom:5px;">
						<table style="width:100%;">
							<tr>
								<td class="title" style="width:230px;">
									{{titles[x_1.cat_key][x_2.cat_key][x_3.cat_key]['Title']}}
								</td>
								<td style="width:420px;">
									<div *ngIf="!entry_vars.timesheet_submitted">
										<div class="dd_search" style="font-size:0.8em;">
											<div style="width:90%;display:inline-block;">
												<input placeholder="Search for Shot/Asset" [(ngModel)]="x_3.searchDD_productionTask" type="text" (keyup)="x_3.projectTask=x_3.cat_key;x_3.dd_results_productionTask = searchDropDown(x_3.searchDD_productionTask, production_tasks,[x_1,x_2,x_3]);dropDownKey($event, x_3, x_3.dd_results_productionTask,[x_1,x_2,x_3], 'productionTask');" (click)="x_3.searchDD_productionTask='';x_3.dd_results_productionTask = searchDropDown(x_3.searchDD_productionTask, production_tasks)"/>
											</div><!--
											--><div style="width:10%;display:inline-block;text-align:right;visibility:hidden;">
												<div class="dd_reveal" (click)="x_3.dd_results_productionTask = dropDownReset($event, production_tasks)">&#9660;</div>
											</div>
										</div>
										<div *ngIf="x_3.dd_results_productionTask">
											<div *ngIf="x_3.dd_results_productionTask.length > 0" (mouseover)="x_3.dd_results_productionTask = dropDownReset(false, x_3.dd_results_productionTask);" class="dd_results" style="width:418px;">
												<div *ngFor="let result of x_3.dd_results_productionTask" [class.dd_result_sel]="result.selected" (click)="x_3.projectTask=x_3.cat_key;x_3.productionTask=result.Cat_key;x_3.searchDD_productionTask=result.Cat_Title;x_3.dd_results_productionTask=false;addRowOptionChange([x_1,x_2,x_3],result)">{{ result.Cat_Title }}</div>
											</div>
										</div>
									</div>
								</td>
								<td>&nbsp;</td>
							</tr>
						</table>
					</div>

					<div *ngFor="let x_4 of x_3.children; let i_4 = 'index'" [class]="(!x_4.indicateRemoval) ? '' : 'indicateRemoval'">
						<table style="width:100%;" [class.addedLine]="(x_1.cat_key + '_' + x_2.cat_key + '_' + x_3.cat_key + '_' + x_4.cat_key) == entry_vars.cur_sel">
							<tr>
								<td class="title">
									<div style="width: 200px;">
										<div>&nbsp;&nbsp;{{ titles[x_1.cat_key][x_2.cat_key][x_3.cat_key][x_4.cat_key]['Title']}}</div>
									</div>
								</td>
								<td>
									<table style="width: 100%;">
										<tr>
											<td class="blank">&nbsp;</td>
											<td *ngFor="let day_i of days;" [class]="x_4.hours[day_i] > 0 || x_4.focus[day_i] ? 'day' : 'day_zero'">
												<input type="text" value="{{ x_4.hours[day_i] > 0 ? x_4.hours[day_i] : '' }}" (focus)="x_4.focus[day_i] = true;" (keyup)="updateHours($event,x_4.hours, day_i)"
												 (keypress)="isNumberKey($event)" (blur)="updateHours($event,x_4.hours, day_i);x_4.focus[day_i] = false;" [class]="x_2.ot[day_i] && x_2.ot_req[day_i] && entry_vars.ot_req[day_i] > 1 ? 'ot_cell' : ''"
												 [disabled]="entry_vars.timesheet_submitted" [style.border]="(entry_vars.timesheet_submitted) ? 'none' : ''" />
											</td>
											<td class="blank">&nbsp;</td>
											<td class="sum hour_sum">
												<div> {{ (x_4.hours[1] + x_4.hours[2] + x_4.hours[3] + x_4.hours[4] + x_4.hours[5] + x_4.hours[6] + x_4.hours[0]) |
													number : '1.2-2'}}</div>
											</td>
											<td style="width:1%">
												<div *ngIf="!entry_vars.show_edit_line_items" [style.opacity]="(entry_vars.timesheet_submitted && x_4.note.length <= 0) ? 0.0 : default"
												 title="Note" (click)="(entry_vars.timesheet_submitted) ? '' : notesToggle(x_4)" (mouseover)="x_4.show_note=true"
												 (mouseout)="x_4.show_note=false" [class]="(x_4.note.length > 0) ? 'note_sel' : 'note'">&nbsp;</div>
												<div *ngIf="entry_vars.show_edit_line_items" [style.opacity]="(entry_vars.timesheet_submitted) ? 0.0 : default" title="Remove"
												 class="minus" (click)="removeLineItem(x_4.children, i_4,[x_1.cat_key,x_2.cat_key,x_3.cat_key,x_4.cat_key])">&nbsp;</div>
											</td>
										</tr>
									</table>
								</td>
							</tr>
						</table>
						<div *ngIf="x_4.show_note_force">
							<div *ngIf="!submit_date">
								<textarea (keyup)="notesUpdate($event,x_4)" class="note_textarea" rows=7>{{ x_4.note }}</textarea>
							</div>
							<div class="note_text" *ngIf="x_4.show_note && submit_date && x_4.note.trim().length > 0">
								<div>{{ x_4.note }}</div>
							</div>
						</div>
						<div class="note_text" *ngIf="x_4.show_note && !x_4.show_note_force && x_4.note.trim().length > 0">
							<div>{{ x_4.note }}</div>
						</div>
					</div>
				</div>

				<div *ngIf="x_3.cat_key == 4 || x_3.cat_key == 5">
					<div *ngFor="let x_4 of x_3.children; let i_3 = 'index'" [class]="(!x_4.indicateRemoval) ? '' : 'indicateRemoval'">

						<div style="margin-bottom:5px;margin-top:20px;">
							<table style="width:100%;">
								<tr>
									<td class="title" style="width:230px;vertical-align:middle;">
										{{ titles[x_1.cat_key][x_2.cat_key][x_3.cat_key]['Title']+"s: " + titles[x_1.cat_key][x_2.cat_key][x_3.cat_key][x_4.cat_key]['Title']}}
									</td>
									<td style="width:420px;">
										<div *ngIf="!entry_vars.timesheet_submitted && false" class="addRowOption_shotAssetSearch">
											<input class="addRowOption_searchShotAsset" type="text" [placeholder]="(x_3.cat_key == 5) ? '&nbsp;Search for Shot' : '&nbsp;Search for Asset'"
											 style="width: 100%;box-sizing:border-box;font-size:0.8em;" (keyup)="searchShotAsset($event,2,x_3.cat_key,x_4)"
											 (click)="$event.target.value='';searchShotAsset($event,2,x_3.cat_key,x_4)">
											<div class="addRowOption" class="addRowOption_shotAssetList" style="z-index:1000;width:418px;">
												<div *ngFor="let el of x_4.results" (click)="selectShotAsset(el, [x_1,x_2,x_3,x_4])">{{ el.Cat_Title }}</div>
											</div>
										</div>


										<div *ngIf="!entry_vars.timesheet_submitted">
											<div class="dd_search" style="font-size:0.8em;">
												<div style="width:90%;display:inline-block;">
													<input placeholder="Search for Shot/Asset" [(ngModel)]="x_4.searchDD_shot" type="text" (keyup)="x_4.assetTask = x_4.cat_key;x_4.shotTask = x_4.cat_key;x_4.productionTask = -1;x_4.projectTask = x_3.cat_key;;x_4.dd_results_shot = searchDropDown(x_4.searchDD_shot, (x_3.cat_key == 4) ? assets : shots,[x_1,x_2,x_3,x_4]);dropDownKey($event, x_4, x_4.dd_results_shot,[x_1,x_2,x_3,x_4], 'shot');" (click)="x_4.searchDD_shot='';x_4.dd_results_shot = searchDropDown(x_4.searchDD_shot, (x_3.cat_key == 4) ? assets : shots)"/>
												</div><!--
												--><div style="width:10%;display:inline-block;text-align:right;visibility:hidden;">
													<div class="dd_reveal" (click)="x_4.dd_results_shot = dropDownReset($event, (x_3.cat_key == 4) ? assets : shots)">&#9660;</div>
												</div>
											</div>
											<div *ngIf="x_4.dd_results_shot">
												<div *ngIf="x_4.dd_results_shot.length > 0" (mouseover)="x_4.dd_results_shot = dropDownReset(false, x_4.dd_results_shot);" class="dd_results" style="width:418px;">
													<div *ngFor="let result of x_4.dd_results_shot" [class.dd_result_sel]="result.selected" (click)="x_4.assetTask = x_4.cat_key;x_4.shotTask = x_4.cat_key;x_4.productionTask = -1;x_4.projectTask = x_3.cat_key;x_4.shot_selected=result;x_4.searchDD_shot=result.Cat_Title;x_4.dd_results_shot=false;addRowOptionChange([x_1,x_2,x_3,x_4],result)">{{ result.Cat_Title }}</div>
												</div>
											</div>
										</div>
									</td>
									<td>&nbsp;</td>
								</tr>
							</table>
						</div>

						<div *ngFor="let x_5 of x_4.children;let i_5 = 'index'" [class]="(!x_5.indicateRemoval) ? '' : 'indicateRemoval'">
							<table style="width:100%;" [class.addedLine]="(x_1.cat_key + '_' + x_2.cat_key + '_' + x_3.cat_key + '_' + x_4.cat_key + '_' + x_5.cat_key) == entry_vars.cur_sel">
								<tr>
									<td class="title">
										<div style="width:  200px;">
											<div>&nbsp;&nbsp;{{ titles[x_1.cat_key][x_2.cat_key][x_3.cat_key][x_4.cat_key][x_5.cat_key]['Title']}}</div>
										</div>
									</td>
									<td>
										<table style="width: 100%;">
											<tr>
												<td class="blank">&nbsp;</td>
												<td *ngFor="let day_i of days;" [class]="x_5.hours[day_i] > 0 || x_5.focus[day_i] ? 'day' : 'day_zero'">
													<input type="text" value="{{ x_5.hours[day_i] > 0 ? x_5.hours[day_i] : '' }}" (focus)="x_5.focus[day_i] = true;" (keyup)="updateHours($event,x_5.hours, day_i)"
													 (keypress)="isNumberKey($event)" (blur)="updateHours($event,x_5.hours, day_i);x_5.focus[day_i] = false;" [class]="x_2.ot[day_i] && x_2.ot_req[day_i] && entry_vars.ot_req[day_i] > 1 ? 'ot_cell' : ''"
													 [disabled]="entry_vars.timesheet_submitted" [style.border]="(entry_vars.timesheet_submitted) ? 'none' : ''"
													/>
												</td>
												<td class="blank">&nbsp;</td>
												<td class="sum hour_sum">
													{{ (x_5.hours[1] + x_5.hours[2] + x_5.hours[3] + x_5.hours[4] + x_5.hours[5] + x_5.hours[6] + x_5.hours[0]) | number : '1.2-2'}}
												</td>
												<td style="width:1%">
													<div *ngIf="!entry_vars.show_edit_line_items" [style.opacity]="(entry_vars.timesheet_submitted && x_5.note.length <= 0) ? 0.0 : default"
													 title="Note" (click)="(entry_vars.timesheet_submitted) ? '' : notesToggle(x_5)" (mouseover)="x_5.show_note=true"
													 (mouseout)="x_5.show_note=false" [class]="(x_5.note.length > 0) ? 'note_sel' : 'note'">&nbsp;</div>
													<div *ngIf="entry_vars.show_edit_line_items" [style.opacity]="(entry_vars.timesheet_submitted) ? 0.0 : default" title="Remove"
													 class="minus" (click)="removeLineItem(x_5.children, i_5,[x_1.cat_key,x_2.cat_key,x_3.cat_key,x_4.cat_key,x_5.cat_key])">&nbsp;</div>
												</td>
											</tr>
										</table>
									</td>
								</tr>
							</table>
							<div *ngIf="x_5.show_note_force">
								<div *ngIf="!submit_date">
									<textarea (keyup)="notesUpdate($event,x_5)" class="note_textarea" rows=7>{{ x_5.note }}</textarea>
								</div>
								<div class="note_text" *ngIf="x_5.show_note && submit_date && x_5.note.trim().length > 0">
									<div>{{ x_5.note }}</div>
								</div>
							</div>
							<div class="note_text" *ngIf="x_5.show_note && !x_5.show_note_force && x_5.note.trim().length > 0">
								<div>{{ x_5.note }}</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div *ngIf="!last" style="height:5px;display:none;">&nbsp;</div>
		</div>
	</div>
</div>
<div class="cat_1 departments">
	<div class="cat_1_title">
		<table style="width:100%;">
			<tr>
				<td class="title">
					<div>Totals</div>
				</td>
				<td>
					<table style="width: 100%;">
						<tr>
							<td class="blank">&nbsp;</td>
							<td *ngFor="let day_i of days_label" class="day">{{ day_i }}</td>
							<td class="blank">&nbsp;</td>
							<td class="sum">&nbsp;</td>
						</tr>
					</table>
				</td>
			</tr>
		</table>
	</div>
	<div class="cat_1_content">
		<div>
			<table style="width:100%;">
				<tr>
					<td style="width: 200px;" class="title">
						<table id="timesheet_totals" style="width: 100%;">
							<tr>
								<td>Regular Time</td>
							</tr>
							<tr *ngIf="timesheet_totals['ot'][7] > 0.0">
								<td>Overtime</td>
							</tr>
							<tr *ngIf="timesheet_totals['dt'][7] > 0.0">
								<td>Double Time</td>
							</tr>
						</table>
					</td>
					<td>
						<table id="timesheet_totals" style="width: 100%;">
							<tr>
								<td class="blank">&nbsp;</td>
								<td *ngFor="let day_i of days" class="day hour_sum" [style.opacity]="(timesheet_totals['rt'][day_i] <= 0) ? 0.25 : 1.0">
									{{ timesheet_totals['rt'][day_i] | number : '1.2-2'}}
								</td>
								<td class="blank">&nbsp;</td>
								<td class="sum" style="font-weight:700;">{{ timesheet_totals['rt'][7] | number : '1.2-2'}}</td>
							</tr>
							<tr *ngIf="timesheet_totals['ot'][7] > 0.0">
								<td class="blank">&nbsp;</td>
								<td *ngFor="let day_i of days" class="day hour_sum" [style.opacity]="(timesheet_totals['ot'][day_i] <= 0) ? 0.25 : 1.0">
									{{ timesheet_totals['ot'][day_i] | number : '1.2-2'}}
								</td>
								<td class="blank">&nbsp;</td>
								<td class="sum" style="font-weight:700;">{{ timesheet_totals['ot'][7] | number : '1.2-2'}}</td>
							</tr>
							<tr *ngIf="timesheet_totals['dt'][7] > 0.0">
								<td class="blank">&nbsp;</td>
								<td *ngFor="let day_i of days" class="day hour_sum" [style.opacity]="(timesheet_totals['dt'][day_i] <= 0) ? 0.25 : 1.0">
									{{ timesheet_totals['dt'][day_i] | number : '1.2-2'}}
								</td>
								<td class="blank">&nbsp;</td>
								<td class="sum" style="font-weight:700;">{{ timesheet_totals['dt'][7] | number : '1.2-2'}}</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</div>
	</div>
</div>

<div class="spacer">&nbsp;</div>

<!-- Footers -->
<div *ngIf="!entry_vars.timesheet_submitted" class="timesheet_footer">
	<div class="submit_btn" (click)="submitTimesheet()">Submit</div>
</div>

<div *ngIf="entry_vars.timesheet_submitted" class="timesheet_submitted_footer">
	<div>Time Sheet Submitted on {{ entry_vars.submit_date }}</div>
</div>